import{c,r as t,b as v,a as y,o as b,p as N,j as e,N as S,d as C,F as E,q as A}from"./index-0Ts42cdv.js";import{C as F}from"./CartCard-Bgqhv4uy.js";import B from"./SuccessPage-D1C3vXEX.js";function U(){const{cartItems:l,total:h,amount:g}=c(s=>s.cart),{user:a,status:j}=c(s=>s.users),{confirmStatus:r}=c(s=>s.orders),[m,D]=t.useState("Москва"),[i,u]=t.useState(""),[n,p]=t.useState(""),[o,x]=t.useState(""),d=v();y(),t.useEffect(()=>{console.log("getting..."),d(b())},[]),t.useEffect(()=>{j==="fulfilled"&&(u(a.address),p(a.email),x(a.phone_number))},[a]),t.useEffect(()=>{r==="fulfilled"&&d(N())},[r]);const f=s=>{s.preventDefault(),d(A({cartItems:l,userDetails:{city:m,address:i,email:n,phone:o},total:h}))};return r==="fulfilled"?e.jsx(B,{type:"success",text:"Заказ успешно оформлен. Наш курьер свяжется с вами.",showLoginBtn:!1}):e.jsxs("div",{className:"dashboard",children:[e.jsx(S,{showBtn:null}),r==="pending"&&e.jsx(C,{}),e.jsxs("div",{className:"page",children:[e.jsxs("div",{className:"orders",children:[e.jsx("h3",{children:"Ваш Заказ:"}),e.jsx("div",{children:l.map(s=>e.jsx(F,{item:s,controls:!1},s.id))}),e.jsxs("div",{children:[e.jsxs("h6",{style:{textAlign:"right",marginBottom:0},children:["Общее количество: ",g," шт."]}),e.jsxs("h6",{style:{textAlign:"right",marginTop:5,marginBottom:20},children:["Итого: ",h.toLocaleString("ru-RU",{style:"currency",currency:"RUB"})]})]})]}),e.jsx("hr",{}),e.jsxs("div",{className:"order-user-info",children:[e.jsx("h4",{children:"Детали доставки:"}),e.jsxs("form",{onSubmit:f,children:[e.jsxs("div",{className:"form-control",style:{margin:"10px 0",padding:"0"},children:[e.jsx("label",{htmlFor:"city",children:"Город:"}),e.jsx("input",{type:"text",id:"city",placeholder:"Москва",disabled:!0,value:m})]}),e.jsxs("div",{className:"form-control",style:{margin:"10px 0",padding:"0"},children:[e.jsx("label",{htmlFor:"address",children:"Адрес:"}),e.jsx("input",{type:"text",id:"address",placeholder:"Адрес",value:i,onChange:s=>u(s.target.value)})]}),e.jsxs("div",{className:"form-control",style:{margin:"10px 0",padding:"0"},children:[e.jsx("label",{htmlFor:"email",children:"Email:"}),e.jsx("input",{type:"email",id:"email",placeholder:"Email",value:n,onChange:s=>p(s.target.value)})]}),e.jsxs("div",{className:"form-control",style:{margin:"10px 0",padding:"0"},children:[e.jsx("label",{htmlFor:"phone_number",children:"Номер телефона:"}),e.jsx("input",{type:"tel",id:"phone_number",placeholder:"Номер телефона",value:o,onChange:s=>x(s.target.value)})]}),e.jsx("button",{className:"primary-button",style:{width:"100%",marginTop:"25px"},disabled:l.length===0||i===""||n===""||o==="",children:"Заказать"})]})]})]}),e.jsx(E,{})]})}export{U as default};
